import pandas as pd

# Read the CSV file
file_path = "your_file.csv"  # Replace with your file path
df = pd.read_csv(file_path)

# Add a helper column to track row numbers for grouping
df["RowIndex"] = df.groupby(["ColA", "cola1", "cola2"]).cumcount()

# Pivot the DataFrame
pivot_df = df.pivot(index="RowIndex", columns=["ColA", "cola1", "cola2"], values="ColB")

# Fill missing values with empty strings
pivot_df = pivot_df.fillna("")

# Adjust the column headers for proper formatting
pivot_df.columns = pd.MultiIndex.from_tuples(pivot_df.columns, names=["ColA", "cola1", "cola2"])

# Write to a CSV file with multi-level headers
output_file = "pivoted_output.csv"
pivot_df.to_csv(output_file, index=False)

print(f"Pivoted data saved to {output_file}")